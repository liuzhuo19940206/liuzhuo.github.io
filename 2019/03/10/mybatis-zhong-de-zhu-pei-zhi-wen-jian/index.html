<!DOCTYPE HTML>

<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Mybatis中的主配置文件, 解忧杂货店">
    <meta name="description" content="今天来讲解Mybatis中的主配置文件，Mybatis的配置文件对整个Mybatis体系产生深远的影响。
Mybatis配置文件层次结构先来看一下MyBatis配置XML文件的层次结构。
&amp;lt;?xml version=&amp;quot;1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Mybatis中的主配置文件 | 解忧杂货店</title>
    <link rel="icon" type="image/bmp" href="/favicon.bmp">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

<script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<script src="/js/jquery.pjax.js"></script>
<script src="//code.tidio.co/sykwy6ppcx3bghffoye9meseevqzcbyg.js"></script>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <span class="logo-span">解忧杂货店</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/messageBoards" class="waves-effect waves-light">
            
            <i class="fa fa-comment"></i>
            
            <span>留言板</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <div class="logo-name">解忧杂货店</div>
        <div class="logo-desc">
            
            未来は私が欲しい未来ではありません!
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        <li>
            <a href="/messageBoards" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-comment"></i>
                
                留言板
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/liuzhuo19940206/liuzhuo19940206.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/liuzhuo19940206/liuzhuo19940206.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>



<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            // if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
            //     alert('密码错误，将返回主页！');
            //     location.href = '/';
            // }
            if (pwd !== prompt('请输入访问本文章的密码')) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/17.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Mybatis中的主配置文件
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }

</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/mybatis/" target="_blank">
                                <span class="chip bg-color">mybatis</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/mybatis/" class="post-category" target="_blank">
                                mybatis
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2019-03-10
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        7.5k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        33 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>今天来讲解Mybatis中的主配置文件，Mybatis的配置文件对整个Mybatis体系产生深远的影响。</p>
<h3 id="Mybatis配置文件层次结构"><a href="#Mybatis配置文件层次结构" class="headerlink" title="Mybatis配置文件层次结构"></a>Mybatis配置文件层次结构</h3><p>先来看一下MyBatis配置XML文件的层次结构。</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;&lt;!--配置--&gt;
    &lt;properties/&gt;&lt;!--属性--&gt;
    &lt;settings/&gt;&lt;!--设置--&gt;
    &lt;typeAliases/&gt;&lt;!--别名--&gt;
    &lt;typeHandlers/&gt;&lt;!--类型处理器--&gt;
    &lt;plugins/&gt;&lt;!--插件--&gt;
    &lt;environments default=&quot;development&quot;&gt;&lt;!--配置环境--&gt;
        &lt;environment id=&quot;development&quot;&gt;&lt;!--环境变量--&gt;
            &lt;transactionManager type=&quot;JDBC&quot;/&gt;&lt;!--事务管理器--&gt;
            &lt;dataSource type=&quot;POOLED&quot;/&gt;&lt;!--数据源--&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;databaseIdProvider/&gt;&lt;!--数据库厂商标识--&gt;
    &lt;mappers/&gt;&lt;!--映射器--&gt;
&lt;/configuration&gt;
</code></pre><font color="red"><strong>注意，这些层次是不能够颠倒顺序的的，如果颠倒顺序，Mybatis在解析XML文件的时候就会出现异常。</strong></font>

<h3 id="properties元素"><a href="#properties元素" class="headerlink" title="properties元素"></a>properties元素</h3><p>properties是一个配置属性的元素，让我们能在配置文件的上下文中使用它。</p>
<p>Mybatis提供3种配置方式：</p>
<ul>
<li><p>property子元素</p>
</li>
<li><p>properties配置文件</p>
</li>
<li><p>程序参数传递</p>
</li>
</ul>
<h4 id="property子元素"><a href="#property子元素" class="headerlink" title="property子元素"></a>property子元素</h4><p>property子元素的配置方式如下：</p>
<pre><code>    &lt;properties&gt;
        &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
        &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;
        &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;
    &lt;/properties&gt;
</code></pre><p>这样我们就可以在上下文中使用已经配置好的属性值了。我们在配置数据库的数据源时就可以按照如下进行配置：</p>
<pre><code>    &lt;dataSource type=&quot;POOLED&quot;&gt;
        &lt;property name=&quot;driver&quot; value=&quot;${driver}&quot;/&gt;
        &lt;property name=&quot;url&quot; value=&quot;${url}&quot;/&gt;
        &lt;property name=&quot;username&quot; value=&quot;${username}&quot;/&gt;
        &lt;property name=&quot;password&quot; value=&quot;${password}&quot;/&gt;
    &lt;/dataSource&gt;
</code></pre><hr>
<h4 id="properties配置文件"><a href="#properties配置文件" class="headerlink" title="properties配置文件"></a>properties配置文件</h4><p>更多时候，我们希望使用properties配置文件来配置属性值，以方便我们在多个配置文件中重复使用它们，也方便日后维护和随时修改，这些在Mybatis中是很容易做到的，我们先来看一下 properties文件 ( jdbc.properties )，代码如下：</p>
<pre><code>#数据库配置文件
driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis
username=root
password=123456
</code></pre><p>我们把这个properties配置文件放在<strong>源码包</strong>下，只要这样引入这个配置文件即可：</p>
<p><code>&lt;properties resources=&quot;jdbc.properties&quot;/&gt;</code></p>
<p>如果想要放在自定义的包下，比如：com.liuzhuo.mybatis中就：</p>
<p><code>&lt;properties resources=&quot;com/liuzhuo/mybatis/jdbc.properties&quot;/&gt;</code></p>
<hr>
<h4 id="程序参数传递"><a href="#程序参数传递" class="headerlink" title="程序参数传递"></a>程序参数传递</h4><p>在实际工作中，我们常常遇到这样的问题：系统是由运维人员去配置的，生产数据库的用户密码对于开发者而言是保密的，而且为了安全，运维人员要求对配置文件中的数据库用户密码进行加密，这样我们的配置文件中往往配置的是加密过后的数据库信息，而无法通过加密的字符串去连接数据库，这个时候可以通过编码的形式来满足我们遇到的场景。</p>
<p>下面假设jdbc.properties文件中的username和password两个属性使用了加密的字符串，这个时候我们需要在生成SqlSessionFactory之前将它转化为明文，而系统已经提供了解密的方法decode(str)，让我们来看看如何使用代码的方式来完成SqlSessionFactory的创建，如下：</p>
<pre><code>    InputStream cfgStream = null;
    Reader cfgReader = null;
    InputStream proStream = null;
    Reader proReader = null;
    Properties properties = null;
    try{
       //读取配置文件流
       cfgStream = Resources.getResourceAsStream(&quot;mybatis-config.xml&quot;);
       cfgReader = new InputStreamReader(cfgStream);

       //读入属性文件
       proStream = Resources.getResourceAsStream(&quot;jdbc.properties&quot;);
       proReader = new InputStreamReader(proStream);

       properties = new Properties();
       properties.load(proReader);

       //解密为明文
       properties.setProperty(&quot;username&quot;,decode(properties.getProperty(&quot;username&quot;)));
       properties.setProperty(&quot;password&quot;,decode(properties.getProperty(&quot;password&quot;)));
    }catch(IOException ex){
      System.out.println(ex.getMessage());
    }

    Synchronized(CLASS_LOCK){
         if(sqlSessionFactory == null){
            //使用属性来创建SqlSessionFactory
            SqlSessionFactory = new SqlSessionFactoryBuilder().build(cfgReader,properties);
         }
    }
</code></pre><p>这样我们完全可以在jdbc.properties配合密文了，满足对系统安全的要求了。</p>
<hr>
<h4 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h4><p>Mybatis支持3种配置方式可能同时出现，并且属性还会重复配置。这3种方式是存在优先级的，Mybatis将按照下面的顺序来加载。</p>
<ol>
<li><p>在properties元素体内指定的属性首先被读取（property子元素）</p>
</li>
<li><p>根据properties元素中的resources属性读取类路径下的.properties文件，或者根据url属性指定的路径读取属性文件，并覆盖也读取的同名属性</p>
</li>
<li><p>读取作为方法参数传递的属性，并覆盖也读取的同名属性</p>
</li>
</ol>
<p><strong>因此，通过<code>方法参数传递的属性具有最高优先级</code>，<code>resources属性中指定的配置文件次之</code>，<code>最低优先级的是properties元素中的指定的属性。</code></strong></p>
<hr>
<p>因此，在实际操作中，我们需要注意一下3点：</p>
<ol>
<li><p>不要混合使用，这样会导致管理混乱</p>
</li>
<li><p>首选的方式是使用properties文件</p>
</li>
<li><p>如果需要使用加密或者其他加工处理，不妨按照示例的方法来处理，这样做的好处是使得配置都来自于同一个配置文件，就不容易产生没有必要的歧义。</p>
</li>
</ol>
<hr>
<p>从MyBatis 3.4.2开始，你可以为占位符指定一个默认值。例如：</p>
<pre><code>&lt;dataSource type=&quot;POOLED&quot;&gt;
  &lt;!-- ... --&gt;
  &lt;property name=&quot;username&quot; value=&quot;${username:ut_user}&quot;/&gt; &lt;!-- If &#39;username&#39; property not present, username become &#39;ut_user&#39; --&gt;
&lt;/dataSource&gt;
</code></pre><p>这个特性默认是关闭的。如果你想为占位符指定一个默认值， 你应该添加一个指定的属性来开启这个特性。例如：</p>
<pre><code>&lt;properties resource=&quot;org/mybatis/example/config.properties&quot;&gt;
  &lt;!-- ... --&gt;
  &lt;property name=&quot;org.apache.ibatis.parsing.PropertyParser.enable-default-value&quot; value=&quot;true&quot;/&gt; &lt;!-- Enable this feature --&gt;
&lt;/properties&gt;
</code></pre><p><strong><code>提示：你可以使用 &quot;:&quot; 作为属性键(e.g. db:username) 或者你也可以在sql定义中使用 OGNL 表达式的三元运算符
(e.g. ${tableName != null ? tableName : &#39;global_constants&#39;})</code></strong></p>
<p>你也可以通过增加一个指定的属性来改变分隔键和默认值的字符。例如：</p>
<pre><code>&lt;properties resource=&quot;org/mybatis/example/config.properties&quot;&gt;
  &lt;!-- ... --&gt;
  &lt;property name=&quot;org.apache.ibatis.parsing.PropertyParser.default-value-separator&quot; value=&quot;?:&quot;/&gt; &lt;!-- Change default value of separator --&gt;
&lt;/properties&gt;

&lt;dataSource type=&quot;POOLED&quot;&gt;
  &lt;!-- ... --&gt;
  &lt;property name=&quot;username&quot; value=&quot;${db:username?:ut_user}&quot;/&gt;
&lt;/dataSource&gt;
</code></pre><hr>
<h3 id="settings设置"><a href="#settings设置" class="headerlink" title="settings设置"></a>settings设置</h3><p>设置（settings）在Mybatis中是最复杂的配置，同时也是最为重要的配置内容之一，它会改变Mybatis运行时的行为。即使不配置settings，Mybatis也可以正常的工作，不过了解settings的配置内容，以及它们的作用仍然十分必要。</p>
<p>Settings的配置内容如下：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310114235.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310114509.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310114547.png"></p>
<p>一个配置完整的 settings 元素的示例如下：</p>
<pre><code>&lt;settings&gt;
  &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;
  &lt;setting name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;
  &lt;setting name=&quot;multipleResultSetsEnabled&quot; value=&quot;true&quot;/&gt;
  &lt;setting name=&quot;useColumnLabel&quot; value=&quot;true&quot;/&gt;
  &lt;setting name=&quot;useGeneratedKeys&quot; value=&quot;false&quot;/&gt;
  &lt;setting name=&quot;autoMappingBehavior&quot; value=&quot;PARTIAL&quot;/&gt;
  &lt;setting name=&quot;autoMappingUnknownColumnBehavior&quot; value=&quot;WARNING&quot;/&gt;
  &lt;setting name=&quot;defaultExecutorType&quot; value=&quot;SIMPLE&quot;/&gt;
  &lt;setting name=&quot;defaultStatementTimeout&quot; value=&quot;25&quot;/&gt;
  &lt;setting name=&quot;defaultFetchSize&quot; value=&quot;100&quot;/&gt;
  &lt;setting name=&quot;safeRowBoundsEnabled&quot; value=&quot;false&quot;/&gt;
  &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;false&quot;/&gt;
  &lt;setting name=&quot;localCacheScope&quot; value=&quot;SESSION&quot;/&gt;
  &lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;OTHER&quot;/&gt;
  &lt;setting name=&quot;lazyLoadTriggerMethods&quot; value=&quot;equals,clone,hashCode,toString&quot;/&gt;
&lt;/settings&gt;
</code></pre><p>在大部分时候我们不需要去配置它，或者只需要配置少数几项即可。</p>
<hr>
<h3 id="typeAliases-别名"><a href="#typeAliases-别名" class="headerlink" title="typeAliases(别名)"></a>typeAliases(别名)</h3><p>别名(typeAliases)是一个指代的名称，因为我们遇到的类的全限定名过长，所以我们希望用一个简短的名称来指代它，而这个名称可以在Mybatis上下文中使用。别名在Mybatis里面分为<strong>系统定义的别名</strong>和<strong>自定义的别名</strong>。注意，在Mybatis中别名是不分大小写的。</p>
<p>一个typeAliases的实例是在解析配置文件时生成的，然后长期保存在Configuration对象中，当我们使用它时，再把它拿出来，这样就没有必要运行的时候再次生成它的实例了。</p>
<h4 id="系统别名"><a href="#系统别名" class="headerlink" title="系统别名"></a>系统别名</h4><p>Mybatis系统定义了一些经常使用的类型的别名，比如：数值、字符串、日期和集合等，我们可以在Mybatis中直接使用它们，在使用时不要重复定义把它们给覆盖了。</p>
<p>如下是系统给我们定义的常用的别名：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310115942.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310120030.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310120122.png"></p>
<p>我们可以通过Mybatis的源码 org.apache.ibatis.type.TypeAliasRegistry 可以看出其自定义注册的信息，如下所示：</p>
<pre><code>  public TypeAliasRegistry() {
    registerAlias(&quot;string&quot;, String.class);

    registerAlias(&quot;byte&quot;, Byte.class);
    registerAlias(&quot;long&quot;, Long.class);
    registerAlias(&quot;short&quot;, Short.class);
    registerAlias(&quot;int&quot;, Integer.class);
    registerAlias(&quot;integer&quot;, Integer.class);
    registerAlias(&quot;double&quot;, Double.class);
    registerAlias(&quot;float&quot;, Float.class);
    registerAlias(&quot;boolean&quot;, Boolean.class);
    ·····
}
</code></pre><p>这些就是Mybatis系统定义的别名，我们无需重复注册它们。</p>
<h4 id="自定义别名"><a href="#自定义别名" class="headerlink" title="自定义别名"></a>自定义别名</h4><p>系统所定义的别名往往是不够用的，因为不同的应用有着不同的需要，所以Mybatis允许自定义别名。</p>
<p>代码如下：</p>
<pre><code>&lt;typeAliases&gt;
  &lt;typeAlias alias=&quot;Author&quot; type=&quot;domain.blog.Author&quot;/&gt;
  &lt;typeAlias alias=&quot;Blog&quot; type=&quot;domain.blog.Blog&quot;/&gt;
  &lt;typeAlias alias=&quot;Comment&quot; type=&quot;domain.blog.Comment&quot;/&gt;
  &lt;typeAlias alias=&quot;Post&quot; type=&quot;domain.blog.Post&quot;/&gt;
  &lt;typeAlias alias=&quot;Section&quot; type=&quot;domain.blog.Section&quot;/&gt;
  &lt;typeAlias alias=&quot;Tag&quot; type=&quot;domain.blog.Tag&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre><p>当这样配置时，Blog可以用在任何使用domain.blog.Blog的地方。</p>
<p>如果POJO对象过多的时候，配置也是非常多的。因此允许我们通过包扫描的方式来注册自定义别名，如下：</p>
<pre><code>&lt;typeAliases&gt;
  &lt;package name=&quot;domain.blog&quot;/&gt;
&lt;/typeAliases&gt;
</code></pre><p>每一个在包 domain.blog 中的 Java Bean，<strong><code>在没有注解的情况下，会使用 Bean 的首字母小写的非限定类名来作为它的别名。</code></strong></p>
<p>比如 domain.blog.Author 的别名为 author。</p>
<p>也可以使用注解的方法，自定义别名，如下：</p>
<pre><code>@Alias(&quot;author&quot;)
public class Author {
    ...
}
</code></pre><p>当配合上面的配置，Mybatis就会自动扫描包，将扫描到的类装载到上下文中，以便将来使用。这样就算是多个POJO也可以通过包扫描的方式装载到Mybatis的上下文中。</p>
<hr>
<h3 id="typeHandler-类型处理器"><a href="#typeHandler-类型处理器" class="headerlink" title="typeHandler(类型处理器)"></a>typeHandler(类型处理器)</h3><p>无论是 MyBatis 在预处理语句（PreparedStatement）中设置一个参数时，还是从结果集中取出一个值时， 都会用类型处理器将获取的值以合适的方式转换成 Java 类型。</p>
<p>由于数据库可能来自于不同的厂商，不同的厂商设置的参数可能有所不同，同时数据库也可以自定义数据类型，typeHandler允许根据项目的需要自定义设置Java传递到数据库的参数中，或者从数据库读取数据，我们也需要进行特殊的处理，这些都可以在自定义的typeHandler中处理，尤其是在使用枚举的时候，我们常常需要使用typeHandler进行转换。</p>
<p>typeHandler和别名一样，分为Mybatis系统定义的和用户自定义两种。一般来说，使用Mybatis系统定义的typeHandler就可以实现大部分的功能，如果使用用户自定义的typeHandler，我们在处理的时候务必要小心谨慎，以避免出现不必要的错误。</p>
<p>typeHandler常用的配置为Java类型（javaType）、JDBC类型（jdbcType）。typeHandler的作用就是将参数从javaType转化为jdbcType，或者从数据库取出数据时把jdbcType转化为javaType。</p>
<h4 id="系统定义的typeHandler"><a href="#系统定义的typeHandler" class="headerlink" title="系统定义的typeHandler"></a>系统定义的typeHandler</h4><p>Mybatis系统内部定义了一系列的typeHandler，我们可以看看 org.apache.ibatis.type.TypeHandlerRegistry</p>
<pre><code>  public TypeHandlerRegistry() {
    register(Boolean.class, new BooleanTypeHandler());
    register(boolean.class, new BooleanTypeHandler());
    register(JdbcType.BOOLEAN, new BooleanTypeHandler());
    register(JdbcType.BIT, new BooleanTypeHandler());

    register(Byte.class, new ByteTypeHandler());
    register(byte.class, new ByteTypeHandler());
    register(JdbcType.TINYINT, new ByteTypeHandler());

    register(Short.class, new ShortTypeHandler());
    register(short.class, new ShortTypeHandler());
    register(JdbcType.SMALLINT, new ShortTypeHandler());

    ····
}
</code></pre><p>下表描述了一些默认的类型处理器。<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310123016.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310123134.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310123216.png"></p>
<hr>
<p>我们需要注意下面几点。</p>
<ul>
<li><p>数值类型的精度，数据库 int、double、decimal这些类型 和 java的 精度、长度都是不一样的。</p>
</li>
<li><p>时间精度，取数据，精确到日用DateOnlyTypeHandler即可，精确到秒就用SqlTimestampTypeHandler等。</p>
</li>
</ul>
<h4 id="自定义typeHandler"><a href="#自定义typeHandler" class="headerlink" title="自定义typeHandler"></a>自定义typeHandler</h4><p>在我们自定义typeHandler之前，我们先学习一下，Mybatis为我们提供的系统typeHandler，这样我们可以照着标准来自定义我们的typeHandler了。</p>
<p>我们来看一下最常见的：StringTypeHandler。</p>
<pre><code>public class StringTypeHandler extends BaseTypeHandler&lt;String&gt; {

  @Override
  public void setNonNullParameter(PreparedStatement ps, int i, String parameter, JdbcType jdbcType)
      throws SQLException {
    ps.setString(i, parameter);
  }

  @Override
  public String getNullableResult(ResultSet rs, String columnName)
      throws SQLException {
    return rs.getString(columnName);
  }

  @Override
  public String getNullableResult(ResultSet rs, int columnIndex)
      throws SQLException {
    return rs.getString(columnIndex);
  }

  @Override
  public String getNullableResult(CallableStatement cs, int columnIndex)
      throws SQLException {
    return cs.getString(columnIndex);
  }
}
</code></pre><p>简单说明一下上面的代码。</p>
<p>StringTypeHandler 继承了 BaseTypeHandler。 而 BaseTypeHandler 实现了接口 typeHandler，并且自己定义了4个抽象的方法。所以继承它的时候，正如本例一样需要实现其定义的4个抽象方法，这些方法已经在StringTypeHandler中使用@Override注解注明了。</p>
<p>setParameter 是 PreparedStatement 对象设置参数，它允许我们自己填写变换的规则。</p>
<p>getResult 则是ResultSet用列名（columnName）或者使用列下标（columnIndex）来获取结果数据的。其中还包括了用CallableStatement（存储过程）获取结果及数据的方法。</p>
<hr>
<p>一般而言，Mybatis系统提供的typeHandler已经能够应付大部分的场景了，但是我们不能排除不够用的情况。首先需要明确两个问题：我们自定义的TypeHandler需要处理什么类型？现有的TypeHandler适合我们使用吗？我们需要特殊的处理java的那些类型（JavaType）和对应处理数据库的那些类型（JdbcType），比如字典项的枚举。</p>
<p>这里让我们重新覆盖一个字符串参数的TypeHandler，我们首先先配置XML文件，确定我们需要处理什么类型的参数和结果，如下所示：</p>
<pre><code>&lt;!-- mybatis-config.xml --&gt;
&lt;typeHandlers&gt;
  &lt;typeHandler handler=&quot;com.liuzhuo.typehandler.MyStringTypehandler&quot; javaType=&quot;string&quot; jdbcType=&quot;VARCHAR&quot;/&gt;
&lt;/typeHandlers&gt;
</code></pre><p>上面定义的数据库类型为VARCHAR型。当java的参数类型为string的时候，我们就可以使用MyStringTypeHandler来处理了，但是只有这个配置，Mybatis不会自动帮你去使用这个TypeHandler去转化的，你需要更多的配置。</p>
<p>对于MyStringTypehandler，我们需要实现：</p>
<p><code>org.apache.ibatis.type.TypeHandler</code> 接口，或者是继承：<code>org.apache.ibatis.type.BaseTypeHandler</code>。</p>
<p>以上就是实现自定义TypeHandler的两种方式（其实BaseTypeHandler就是实现了TypeHandler接口的类）</p>
<pre><code>@MappedJdbcTypes(JdbcType.VARCHAR)
@MappedTypes({String.class})
public class MyStringTypehandler extends BaseTypeHandler&lt;String&gt; {

  @Override
  public void setNonNullParameter(PreparedStatement ps, int i, String parameter, JdbcType jdbcType) throws SQLException {
    System.out.println(&quot;使用了我的TypeHandler&quot;);
    ps.setString(i, parameter);
  }

  @Override
  public String getNullableResult(ResultSet rs, String columnName) throws SQLException {
    System.out.println(&quot;使用了我的TypeHandler，ResultSet列名获取字符串&quot;);
    return rs.getString(columnName);
  }

  @Override
  public String getNullableResult(ResultSet rs, int columnIndex) throws SQLException {
    System.out.println(&quot;使用了我的TypeHandler，ResultSet下标获取字符串&quot;);
    return rs.getString(columnIndex);
  }

  @Override
  public String getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {
    System.out.println(&quot;使用了我的TypeHandler，CallableStatement下标获取字符串&quot;);
    return cs.getString(columnIndex);
  }
}
</code></pre><p>自定义的TypeHandler里，使用了注解 @MappedTypes 和 @MappedJdbcTypes 来配置 javaType 和 jdbcType。</p>
<ul>
<li><p>@MappedTypes：定义的是JavaType类型，可以指定哪些java类型被拦截</p>
</li>
<li><p>@MappedJdbcTypes：定义的是JdbcType类型，它需要满足枚举类型 org.apache.ibatis.type.JdbcType所列的枚举类型。</p>
</li>
</ul>
<font color="red">要注意 MyBatis 不会窥探数据库元信息来决定使用哪种类型，所以你必须在参数和结果映射中指明那是 VARCHAR 类型的字段， 以使其能够绑定到正确的类型处理器上。 这是因为：MyBatis 直到语句被执行才清楚数据类型。</font>

<hr>
<p>通过类型处理器的泛型，MyBatis 可以得知该类型处理器处理的 Java 类型，不过这种行为可以通过两种方法改变：</p>
<ul>
<li><p>在类型处理器的配置元素（typeHandler element）上增加一个 javaType 属性（比如：javaType=”String”）；</p>
</li>
<li><p>在类型处理器的类上（TypeHandler class）增加一个 @MappedTypes 注解来指定与其关联的 Java 类型列表。 如果在 javaType 属性中也同时指定，则注解方式将被忽略。</p>
</li>
</ul>
<p>可以通过两种方式来指定被关联的 JDBC 类型：</p>
<ul>
<li><p>在类型处理器的配置元素上增加一个 jdbcType 属性（比如：jdbcType=”VARCHAR”）；</p>
</li>
<li><p>在类型处理器的类上（TypeHandler class）增加一个 @MappedJdbcTypes 注解来指定与其关联的 JDBC 类型列表。 如果在 jdbcType 属性中也同时指定，则注解方式将被忽略。</p>
</li>
</ul>
<p>即优先级是：</p>
<pre><code>&lt;typeHandler handler=&quot;xxx&quot; javaType=&quot;string&quot; jdbcType=&quot;VARCHAR&quot;/&gt;  中的 javaType 和 jdbcType 大于 @MappedTypes 和 @MappedJdbcTypes
</code></pre><hr>
<p>当决定在ResultMap中使用某一TypeHandler时，此时java类型是已知的（从结果类型中获得），但是JDBC类型是未知的。 </p>
<p>因此Mybatis使用 javaType=[TheJavaType], jdbcType=null 的组合来选择一个TypeHandler。 </p>
<p>这意味着使用@MappedJdbcTypes注解可以限制TypeHandler的范围，同时除非显式的设置，否则TypeHandler在ResultMap中将是无效的。 </p>
<p>如果希望在ResultMap中使用TypeHandler，那么设置@MappedJdbcTypes注解的includeNullJdbcType=true即可。 </p>
<p>然而从Mybatis 3.4.0开始，如果只有一个注册的TypeHandler来处理Java类型，那么它将是ResultMap使用Java类型时的默认值（即使没有includeNullJdbcType=true）。</p>
<hr>
<p>最后，类型处理器也可以和别名一样，使用包扫描的方式，注册多个类型处理器</p>
<pre><code>&lt;!-- mybatis-config.xml --&gt;
&lt;typeHandlers&gt;
  &lt;package name=&quot;org.mybatis.example&quot;/&gt;
&lt;/typeHandlers&gt;
</code></pre><p>注意在使用自动检索（autodiscovery）功能的时候，只能通过注解方式来指定 JDBC 的类型。（@MappedJdbcTypes）</p>
<hr>
<p>到现在，我们还是不能测试，因为还需要去标识哪些参数或者结果类型去用我们自定义的TypeHandler去转化，在没有任何标识的情况下，Mybatis是不会启用你定义的TypeHandler进行转化的，所以还需要给予对应的标识，比如配置jdbcType 和 javaType，或者直接使用typeHandler属性指定，因此还需要修改映射器的XML配置。</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.liuzhuo.dao.UserMapper&quot;&gt;
    &lt;resultMap id=&quot;usermap&quot; type=&quot;user&quot;&gt;&lt;!--因为添加了别名，所以直接使用user--&gt;
        &lt;id column=&quot;userId&quot; property=&quot;userId&quot; javaType=&quot;string&quot; jdbcType=&quot;VARCHAR&quot;/&gt;
        &lt;result column=&quot;user_age&quot; property=&quot;userAge&quot;/&gt;
            &lt;!--定义结果类型转化器标识，才能使用类型转换器--&gt;
        &lt;result column=&quot;user_name&quot; property=&quot;userName&quot; typeHandler=&quot;com.liuzhuo.typehandler.MyStringTypehandler&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;selectById&quot; parameterType=&quot;long&quot; resultMap=&quot;usermap&quot;&gt;
        select userId,user_name as userName,user_age as userAge from user where userId = #{id}
    &lt;/select&gt;

    &lt;select id=&quot;selectById03&quot; parameterType=&quot;string&quot; resultMap=&quot;usermap&quot;&gt;
        select userId,user_name as userName,user_age as userAge from user where user_name = #{userName,javaType=&quot;string&quot;,jdbcType=&quot;VARCHAR&quot;}
    &lt;/select&gt;

    &lt;select id=&quot;selectById02&quot; parameterType=&quot;string&quot; resultMap=&quot;usermap&quot;&gt;
        select userId,user_name as userName,user_age as userAge from user where user_name = #{userName,typeHandler=&quot;com.liuzhuo.typehandler.MyStringTypehandler}
    &lt;/select&gt;

&lt;/mapper&gt;
</code></pre><p>我们这里引入了resultMap，它提供了映射规则，这里给出了3种typeHandler的使用方法。</p>
<ul>
<li><p>在配置文件里面配置，在结果集的的id定义：javaType 和 jdbcType。只要定义的javaType 和 jdbcType 与我们定义在配置里面的typeHandler是一致的，Mybatis才会知道用我们自定义的类型转化器进行转换。</p>
</li>
<li><p>映射集里面直接定义具体的typeHandler，这样就不需要再在配置里面定义了。</p>
</li>
<li><p>在参数中制定typeHandler，这样Mybatis就会用对应的typeHandler进行转换，这样也不需要在配置里面定义了。</p>
</li>
</ul>
<hr>
<p>配置好后，运行我们的项目的MybatisMain主函数，接着上篇博客来写的：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310151142.png"></p>
<p>从结果看，程序运行了我们自定义的typeHandler，输出了打印语句。</p>
<hr>
<h4 id="处理枚举类型"><a href="#处理枚举类型" class="headerlink" title="处理枚举类型"></a>处理枚举类型</h4><p>在Mybatis中枚举类型的typeHandler有自己特殊的规则，Mybatis内部提供了两个枚举typeHandler：</p>
<ul>
<li><p>EnumTypeHandler </p>
</li>
<li><p>EnumOrdinalTypeHandler </p>
</li>
</ul>
<p>EnumTypeHandler 和 EnumOrdinalTypeHandler 都是泛型类型处理器（generic TypeHandlers）</p>
<p>其中，EnumTypeHandler是使用枚举字符串名称来作为参数的，EnumOrdinalTypeHandler是使用整数下标作为参数的。</p>
<p><strong>注意 EnumTypeHandler 在某种意义上来说是比较特别的，其他的处理器只针对某个特定的类，而它不同，它会处理任意继承了 Enum 的类。</strong></p>
<p>然而这两个枚举类型应用却不是那么广泛，更多的时候我们希望使用自定义的typeHandler处理它们。所以在这里我们也会谈及自定义的typeHandler实现枚举映射。</p>
<h5 id="EnumOrdinalTypeHandler"><a href="#EnumOrdinalTypeHandler" class="headerlink" title="EnumOrdinalTypeHandler"></a>EnumOrdinalTypeHandler</h5><p>下面以性别为例，讲述如何实现枚举类。现在我们有一个性别枚举，它定义了字典：男（male），女（female）。</p>
<p>在com.liuzhuo.enums包下，创建Sex枚举类</p>
<pre><code>public enum Sex {

    MALE(1, &quot;男&quot;), FEMALE(2, &quot;女&quot;);

    private int id;
    private String name;

    private Sex(int id, String name) {
        this.id = id;
        this.name = name;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public static Sex getSex(int id) {
        if (id == 1) {
            return MALE;
        } else if (id == 2) {
            return FEMALE;
        }
        return null;
    }
}
</code></pre><p>在没有配置的时候，EnumOrdinalTypeHandler是Mybatis的默认枚举类型的处理器，为了让EnumOrdinalTypeHandler能够处理它，我们在Mybatis中做如下配置：</p>
<pre><code>    &lt;typeHandlers&gt;
        ···
        &lt;typeHandler handler=&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot; javaType=&quot;com.liuzhuo.enums.Sex&quot;/&gt;
    &lt;/typeHandlers&gt;
</code></pre><p>这样当Mybatis遇到这个枚举类时就可以识别这个枚举了，然后修改userMapper.xml文件</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.liuzhuo.dao.UserMapper&quot;&gt;

    &lt;resultMap id=&quot;userMap&quot; type=&quot;user&quot;&gt;&lt;!--因为添加了别名，所以直接使用user--&gt;
        &lt;id column=&quot;userId&quot; property=&quot;userId&quot; javaType=&quot;string&quot; jdbcType=&quot;VARCHAR&quot;/&gt;
        &lt;result column=&quot;user_age&quot; property=&quot;userAge&quot;/&gt;
        &lt;!--定义结果类型转化器标识，才能使用类型转换器--&gt;
        &lt;result column=&quot;user_name&quot; property=&quot;userName&quot; typeHandler=&quot;com.liuzhuo.typehandler.MyStringTypehandler&quot;/&gt;
        &lt;!--新添加的字段--&gt;
        &lt;result column=&quot;user_sex&quot; property=&quot;userSex&quot; typeHandler=&quot;org.apache.ibatis.type.EnumOrdinalTypeHandler&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;selectById&quot; parameterType=&quot;long&quot; resultMap=&quot;userMap&quot;&gt;
        select userId,user_name as userName,user_age as userAge ,user_sex as userSex from user where userId = #{id}
    &lt;/select&gt;

    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;user&quot;&gt;
        INSERT INTO user(userId,user_age,user_name,user_sex)
        VALUES (#{userId},#{userAge},#{userName},#{userSex,typeHandler=org.apache.ibatis.type.EnumOrdinalTypeHandler})
    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><p>主要增加了一个新的字段，userSex 和 一个 insert方法。</p>
<p>userMapper接口：</p>
<pre><code>public interface UserMapper {

    User selectById(Long id);

    @Select(&quot;select userId,user_age as useAge,user_name as userName from user where userId = #{id}&quot;)
    User selectById02(Long id);

    //新增加的方法
    int insertUser(User user);
}

</code></pre><p>User类：</p>
<pre><code>public class User {
    private String userId;
    private Long userAge;
    private String userName;
    //多的字段
    private Sex userSex;  

    ···省略get、set、toSting方法
</code></pre><p>在mysql中，添加新的列，为user_sex<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310155623.png"></p>
<p>修改我们的MybatisMain类的main方法：</p>
<pre><code>        SqlSession sqlSession = null;
        try {
            sqlSession = SqlSessionFactoryUtil.openSqlSession();
            UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
            User user = new User();
            user.setUserId(UUID.randomUUID().toString());
            user.setUserName(&quot;dj&quot;);
            user.setUserAge(18L);
            user.setUserSex(Sex.FEMALE);//插入新增加的枚举类型
            userMapper.insertUser(user);
            sqlSession.commit();
        } catch (Exception e) {
            System.out.println(e.getMessage());
            //出现异常，回滚
            sqlSession.rollback();
        } finally {
            //关闭sqlSession对象
            if (sqlSession != null) {
                sqlSession.close();
            }
        }
    }
</code></pre><p>执行结果：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310155821.png"><br>打开sql数据库：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310155921.png"></p>
<p>发现它插入的是枚举类型的下标。</p>
<hr>
<p>然后，再次修改MybatisMain类的main方法：</p>
<pre><code>        SqlSession sqlSession = null;
        try {
            sqlSession = SqlSessionFactoryUtil.openSqlSession();
            UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
            //id是数据库的，请填写你的id
            User user = userMapper.selectById(&quot;a582c9ec-872b-4f6e-8520-a924e140efd7&quot;);
            System.out.println(user);
            sqlSession.commit();
        } catch (Exception e) {
            System.out.println(e.getMessage());
            //出现异常，回滚
            sqlSession.rollback();
        } finally {
            //关闭sqlSession对象
            if (sqlSession != null) {
                sqlSession.close();
            }
        }
</code></pre><p>执行：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310161623.png"></p>
<p>运行成功，取数据时，根据枚举的下标进行转化，变成了FEMALE。</p>
<font color="red">注意，执行select后，打印出来的user的有可能有的字段没有值，这是因为当我们的使用resultMap后，select中就不要使用as了，这样会映射不对的！！！</font>

<p>即：(去掉所有的as)</p>
<pre><code>    &lt;select id=&quot;selectById&quot; parameterType=&quot;string&quot; resultMap=&quot;userMap&quot;&gt;
        select userId,user_age ,user_name ,user_sex  from user where userId = #{id}
    &lt;/select&gt;
</code></pre><hr>
<h5 id="EnumTypeHandler"><a href="#EnumTypeHandler" class="headerlink" title="EnumTypeHandler"></a>EnumTypeHandler</h5><p>EnumTypeHandler是使用枚举名称去处理Java枚举类型。EnumTypeHandler对应的是一个字符串，让我们来看看它的用法。</p>
<p>首先将mysql中的user_sex改为<code>VARCHAR</code>类型，然后修改映射的xml文件。<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310162436.png"></p>
<p>将typeHandler换成：org.apache.ibatis.type.EnumTypeHandler 即可。</p>
<p>再次插入数据后：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310162944.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310163028.png"></p>
<hr>
<h5 id="自定义枚举类的typeHandler"><a href="#自定义枚举类的typeHandler" class="headerlink" title="自定义枚举类的typeHandler"></a>自定义枚举类的typeHandler</h5><p>我们也看到了Mybatis系统内部的枚举类的typeHandler不太好，所以，一般情况下，我们都需要自己定义枚举类的typeHandler。</p>
<p>创建SexEnumTypeHandler：</p>
<pre><code>public class SexEnumTypeHandler extends BaseTypeHandler&lt;Sex&gt; {
    @Override
    public void setNonNullParameter(PreparedStatement ps, int i, Sex parameter, JdbcType jdbcType) throws SQLException {
        System.out.println(&quot;自定义的枚举类型，set&quot;);
        ps.setInt(i, parameter.getId());
    }

    @Override
    public Sex getNullableResult(ResultSet rs, String columnName) throws SQLException {
        System.out.println(&quot;自定义的枚举类型，get&quot;);
        int id = rs.getInt(columnName);
        return Sex.getSex(id);
    }

    @Override
    public Sex getNullableResult(ResultSet rs, int columnIndex) throws SQLException {
        System.out.println(&quot;自定义的枚举类型，get&quot;);
        int id = rs.getInt(columnIndex);
        return Sex.getSex(id);
    }

    @Override
    public Sex getNullableResult(CallableStatement cs, int columnIndex) throws SQLException {
        System.out.println(&quot;自定义的枚举类型，get&quot;);
        int id = cs.getInt(columnIndex);
        return Sex.getSex(id);
    }
}
</code></pre><p>修改mbatis-config.xml配置文件：</p>
<pre><code>    &lt;typeHandlers&gt;
        ···
        &lt;typeHandler handler=&quot;com.liuzhuo.typehandler.SexEnumTypeHandler&quot; javaType=&quot;com.liuzhuo.enums.Sex&quot;/&gt;
    &lt;/typeHandlers&gt;
</code></pre><p>修改userMapper.xml文件：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;


&lt;mapper namespace=&quot;com.liuzhuo.dao.UserMapper&quot;&gt;

    &lt;resultMap id=&quot;userMap&quot; type=&quot;user&quot;&gt;
        &lt;id column=&quot;userId&quot; property=&quot;userId&quot; javaType=&quot;string&quot; jdbcType=&quot;VARCHAR&quot;/&gt;
        &lt;result column=&quot;user_age&quot; property=&quot;userAge&quot;/&gt;
        &lt;!--定义结果类型转化器标识，才能使用类型转换器--&gt;
        &lt;result column=&quot;user_name&quot; property=&quot;userName&quot; typeHandler=&quot;com.liuzhuo.typehandler.MyStringTypehandler&quot;/&gt;
        &lt;!--新添加的字段--&gt;
        &lt;result column=&quot;user_sex&quot; property=&quot;userSex&quot; typeHandler=&quot;com.liuzhuo.typehandler.SexEnumTypeHandler&quot;/&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;selectById&quot; parameterType=&quot;string&quot; resultMap=&quot;userMap&quot;&gt;
        select userId,user_age ,user_name ,user_sex  from user where userId = #{id}
&lt;/select&gt;

    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;user&quot;&gt;
        INSERT INTO user(userId,user_age,user_name,user_sex)
        VALUES (#{userId},#{userAge},#{userName},#{userSex,typeHandler=com.liuzhuo.typehandler.SexEnumTypeHandler})
    &lt;/insert&gt;

&lt;/mapper&gt;
</code></pre><p>修改主函数：</p>
<pre><code>            sqlSession = SqlSessionFactoryUtil.openSqlSession();
            UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
            User user = new User();
            user.setUserId(UUID.randomUUID().toString());
            user.setUserName(&quot;gakkij&quot;);
            user.setUserAge(18L);
            user.setUserSex(Sex.FEMALE);
            userMapper.insertUser(user);
            sqlSession.commit();
</code></pre><p><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310164451.png"><br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310164520.png"></p>
<hr>
<p>修改主函数：</p>
<pre><code>            sqlSession = SqlSessionFactoryUtil.openSqlSession();
            UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
            User user = userMapper.selectById(&quot;635a61a2-1d0e-450a-bda1-20aa340567db&quot;);
            System.out.println(user);
            sqlSession.commit();
</code></pre><p><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310164703.png"></p>
<hr>
<h3 id="ObjectFactory"><a href="#ObjectFactory" class="headerlink" title="ObjectFactory"></a>ObjectFactory</h3><p>当Mybatis在构建一个结果返回的时候，都会使用ObjectFactory（对象工厂）去构建POJO，在Mybatis中可以定制自己的对象工厂。一般来说我们使用默认的ObjectFactory即可，Mybatis中默认的ObjectFactory是由 org.apache.ibatis.reflection.DefaultObjectFactory来提供服务的。在大部分的场景下我们都不用修改，如果要定制特定的工厂则需要进行配置，如下所示：</p>
<pre><code>&lt;objectFactory type=&quot;com.liuzhuo.objectFactory.MyObjectFactory&quot;&gt;
    &lt;property name=&quot;name&quot; value=&quot;MyObjectFactory&quot;/&gt;
&lt;/objectFactory&gt;
</code></pre><p>这里，我们配置了一个对象工厂MyObjectFactory，对它的要求是实现ObjectFactory的接口。实际上DefaultObjectFactory已经实现了ObjectFactory的接口，我们可以通过继承DefaultObjectFactory来简化编程。</p>
<p>在com.liuzhuo.objectFactory包下，创建MyObjectFactory类：</p>
<pre><code>public class MyObjectFactory extends DefaultObjectFactory {

    private static final long serialVersionUID = -4783947743847934344L;

    Logger log = Logger.getLogger(MyObjectFactory.class);

    @Override
    public void setProperties(Properties properties) {
        log.info(&quot;定制属性：&quot; + properties);
        super.setProperties(properties);
    }

    @Override
    public &lt;T&gt; T create(Class&lt;T&gt; type) {
        log.info(&quot;使用定制对象工厂的create方法构建单个对象&quot;);
        return super.create(type);
    }

    @Override
    public &lt;T&gt; T create(Class&lt;T&gt; type, List&lt;Class&lt;?&gt;&gt; constructorArgTypes, List&lt;Object&gt; constructorArgs) {
        log.info(&quot;使用定制对象工厂的create方法构建列表对象&quot;);
        return super.create(type, constructorArgTypes, constructorArgs);
    }

    @Override
    public &lt;T&gt; boolean isCollection(Class&lt;T&gt; type) {
        return super.isCollection(type);
    }
}
</code></pre><p><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310175851.png"></p>
<p>运行我们的main方法：<br><img src="https://gakkil.gitee.io/gakkil-image/mybatis/QQ截图20190310180429.png"></p>
<p>从运行的结果可以看出，首先，setProperties方法可以获取到<code>&lt;property name=&quot;name&quot; value=&quot;MyObjectFactory&quot;/&gt;</code>定义的属性值。</p>
<p>create方法分别是处理单个对象和列表对象。</p>
<p>注意，大部分情况下，我们不需要使用自己配置的ObjectFactory，使用默认的即可。</p>
<hr>
<h3 id="plugins-插件"><a href="#plugins-插件" class="headerlink" title="plugins(插件)"></a>plugins(插件)</h3><p>MyBatis 允许你在已映射语句执行过程中的某一点进行拦截调用。默认情况下，MyBatis 允许使用插件来拦截的方法调用包括：</p>
<ul>
<li><p>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)</p>
</li>
<li><p>ParameterHandler (getParameterObject, setParameters)</p>
</li>
<li><p>ResultSetHandler (handleResultSets, handleOutputParameters)</p>
</li>
<li><p>StatementHandler (prepare, parameterize, batch, update, query)</p>
</li>
</ul>
<p>这些类中方法的细节可以通过查看每个方法的签名来发现，或者直接查看 MyBatis 发行包中的源代码。 如果你想做的不仅仅是监控方法的调用，那么你最好相当了解要重写的方法的行为。 <strong>因为如果在试图修改或重写已有方法的行为的时候，你很可能在破坏 MyBatis 的核心模块。 这些都是更低层的类和方法，所以使用插件的时候要特别当心。</strong></p>
<p>通过 MyBatis 提供的强大机制，使用插件是非常简单的，只需实现 Interceptor 接口，并指定想要拦截的方法签名即可。</p>
<pre><code>// ExamplePlugin.java
@Intercepts({@Signature(
  type= Executor.class,
  method = &quot;update&quot;,
  args = {MappedStatement.class,Object.class})})
public class ExamplePlugin implements Interceptor {
  public Object intercept(Invocation invocation) throws Throwable {
    return invocation.proceed();
  }
  public Object plugin(Object target) {
    return Plugin.wrap(target, this);
  }
  public void setProperties(Properties properties) {
  }
}
</code></pre><pre><code>&lt;!-- mybatis-config.xml --&gt;
&lt;plugins&gt;
  &lt;plugin interceptor=&quot;org.mybatis.example.ExamplePlugin&quot;&gt;
    &lt;property name=&quot;someProperty&quot; value=&quot;100&quot;/&gt;
  &lt;/plugin&gt;
&lt;/plugins&gt;
</code></pre><p>上面的插件将会拦截在 Executor 实例中所有的 “update” 方法调用， 这里的 Executor 是负责执行低层映射语句的内部对象。</p>

            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://gakkil.gitee.io" class="b-link-green">解忧杂货店</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2019/03/10/mybatis-zhong-de-zhu-pei-zhi-wen-jian/" class="b-link-green">Mybatis中的主配置文件</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments input[type=text],
    #vcomments input[type=email],
    #vcomments input[type=url],
    #vcomments textarea {
        box-sizing: border-box;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #42b983;
        font-weight: 500;
        text-decoration: underline;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div id="vcomments" class="card-content"></div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'czeMb63q1knq7zTW4KYb3PiR-gzGzoHsz',
        appKey: 'TOIvQuWMaVWiLDCAl2kE6PLE',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'identicon',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊! '
    });
</script>
    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2019/03/10/mybatis-zhong-de-zhu-pei-zhi-wen-jian-02/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="Mybatis中的主配置文件02">
                        
                        <span class="card-title">Mybatis中的主配置文件02</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">
                      
                                讲解Mybatis-config.xml配置文件
                      
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2019-03-10
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/mybatis/" class="post-category" target="_blank">
                                    mybatis
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/mybatis/" target="_blank">
                        <span class="chip bg-color">mybatis</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/03/09/mybatis-de-di-san-tian-zuo-yong-yu/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="Mybatis的第三天作用域">
                        
                        <span class="card-title">Mybatis的第三天作用域</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">
                       
                                探讨Mybatis中的各个对象的作用域和生命周期
                      
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2019-03-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/mybatis/" class="post-category" target="_blank">
                                    mybatis
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/mybatis/" target="_blank">
                        <span class="chip bg-color">mybatis</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 解忧杂货店<br />'
            + '作者: 刘小宅<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down" style="
     margin-right: 70px;
     margin-bottom: 15px;
">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>




<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            gakki酱的小迷弟
            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">384.3k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/liuzhuo19940206" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="https://weibo.com/3310889015" class="tooltipped" target="_blank" data-tooltip="微博" data-position="top" data-delay="50">
        <i class="fa fa-weibo"></i>
    </a>



    <a href="mailto:575920824@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=575920824" class="tooltipped" data-tooltip="QQ联系我: 575920824" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>

</html>